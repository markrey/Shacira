/*.SH.*/

/*
 *  Headerfile for module eb_dde
 *
 *  Generated by C-Head Version 1.3
 *  (c) 1993 by 2i Industrial Informatics GmbH
 *
 *  This file has been extracted from the source file
 *  eb_dde.cpp on Sunday February 24 2002  11:20:59
 */

#ifndef __eb_dde__
#define __eb_dde__


// Headerfiles
// ===========================================================================

#include "base/eb_base.hpp"
#include "base/eb_str.hpp"
#include "base/eb_err.hpp"

#include <windows.h>
#include <ddeml.h>


class __ECL_DLLEXPORT__ cDde : public cBase {
   //
   // Fehlerbehandlung
   //
public:
   enum ERR_CODE { errBase = ERR_PREFIX('D','D','E'),
      // Information
      // err??? = errBase + errInfo,

      // Warnungen
      // err??? = errBase + errWarn,

      // Fehler
      errDdeFailed = errBase + errError,
      errDdeTimeout,

      // Fatale Fehler
      errDdeInit = errBase+errFatal,
   };

public:
   // Initialize and Connect
   cDde(cString _service, cString _topic);
   // Uninitialize
   ~cDde();

   void poke(cString _item, cString _Value);
   void poke(cString _item, const char *_buffer, int _size);
   cString request(cString _item);
   void execute(cString _cmd);

   static HDDEDATA CALLBACK callback(UINT uType,UINT uFmt,HCONV hconv,
      HSZ hsz1, HSZ hsz2, HDDEDATA hdata, DWORD dwData1, DWORD dwData2);

private:
   DWORD idInst;     // instance identifier
   HCONV hConv;      // handle to conversation

   cErrBase::ERR_TYPE cvtDdeError(UINT _api_err);
};


#endif

/*.EH.*/
