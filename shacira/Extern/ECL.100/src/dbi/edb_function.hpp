/*.SH.*/

/*
 *  Headerfile for module edb_function
 *
 *  Generated by C-Head Version 1.3
 *  (c) 1993 by 2i Industrial Informatics GmbH
 *
 *  This file has been extracted from the source file
 *  edb_function.cpp on Wednesday March 20 2002  22:46:29
 */

#ifndef __edb_function__
#define __edb_function__


// Headerfiles
// ===========================================================================

#include "dbi/edb_cursor.hpp"
#include "dbi/edb_transaction.hpp"
#include "base/eb_sema.hpp"


// ===========================================================================
// cdbFunction
// ---------------------------------------------------------------------------
//
// cdbTAObject
//  +--cdbFunction
//
// ===========================================================================

class __ECL_DLLEXPORT__ cdbFunction : public cdbTAObject {

public:

   // Konstruktor ueber TA-Zeiger
   cdbFunction(cdbTransaction *ta);
   // Konstruktor ueber TA-Referenz
   cdbFunction(cdbTransaction& ta);


   // Ausfuehren von SELECTs
   // ======================

   // SELECT mit int-Ergebnis
   int selectInt(SQL::SELECT sql);
   // SELECT mit double-Ergebnis
   double selectDbl(SQL::SELECT sql);
   // SELECT mit String-Ergebnis
   cString selectStr(SQL::SELECT sql);


protected:

   // Events
   // ======

   // Wird aufgerufen, um die Aktion 'func' auszufuehren
   void onExecAction(cdbDatabase *db, int func);
   // Wird aufgerufen, um den Abbruch der aktuellen Aktion anzufordern
   void onStopAction();
   // Wird aufgerufen, um eine textuelle Signatur der Aktion zu ermitteln
   cString onGetSignature();


private:

   SQL::SELECT sql;           // Auszufuehrendes SQL-Statement (nur SELECT moeglich)

   cdbCursor *current_cu;     // Zeiger auf aktuellen Cursor (oder 0)
   cMutexSem protect_cu_ptr;  // Personenschutz fuer diesen Zeiger
   cErrBase last_error;       // Zuletzt aufgetretener Fehler

   int res_int;               // Result-Variable fuer int-Ergebnisse
   double res_dbl;            // Result-Variable fuer double-Ergebnisse
   cString res_str;           // Result-Variable fuer cString-Ergebnisse

   // current_cu setzen (semaphorengeschuetzt)
   void setCurrentCursor(cdbCursor *cu);

};


#endif

/*.EH.*/
